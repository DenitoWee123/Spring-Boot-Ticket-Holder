# Ticket Holder – Spring Boot REST Application

## Описание
Ticket Holder е Spring Boot REST приложение, което реализира бизнес логика
за управление на ограничен ресурс (места/билети) с поддръжка на конкурентен достъп.

Основната цел на проекта е да демонстрира как системата предотвратява
едновременно резервиране на едно и също място от повече от един потребител.

---

## Бизнес логика

### Състояния на място
Всяко място може да бъде в едно от следните състояния:
- **AVAILABLE** – свободно място
- **HELD** – временно задържано за конкретен потребител
- **SOLD** – финално закупено

### HOLD (временно задържане)
- Потребител може да задържи свободно място.
- Всяко задържане е валидно **10 минути (TTL)**.
- Ако мястото вече е задържано или продадено, операцията се отказва.
- Ако задържането не бъде потвърдено навреме, мястото автоматично се освобождава.

### CONFIRM (покупка)
- Само потребителят, който е задържал мястото, може да го закупи.
- След покупка мястото преминава в състояние **SOLD** и не може да бъде резервирано отново.

---

## Конкурентност и синхронизация

Проектът решава класически конкурентен проблем:
> Какво се случва, когато двама клиента се опитат да резервират едно и също място едновременно?

### Решение
- Използва се **заключване на ниво място (per-seat locking)**.
- Всяка операция за задържане или покупка е атомарна.
- Това гарантира, че:
  - само един потребител може да задържи дадено място
  - не е възможно двойно резервиране
  - системата остава в консистентно състояние

---

## Автоматично освобождаване (TTL)
- Фонов процес периодично проверява всички задържани места.
- Ако времето за задържане е изтекло, мястото автоматично се връща в състояние **AVAILABLE**.
- Това предотвратява блокиране на ресурси от незавършени резервации.

---

## REST интерфейс

Приложението предоставя REST API за:
- преглед на всички места
- преглед на конкретно място
- временно задържане (HOLD)
- финализиране на покупка (CONFIRM)

Операциите връщат коректни HTTP статуси при успех и при грешки.

---

## HTTP статуси
- **200 OK** – успешна операция
- **403 Forbidden** – опит за покупка от потребител, който не държи мястото
- **409 Conflict** – мястото вече е задържано или продадено
- **404 Not Found** – несъществуващо място
- **410 Gone** – задържането е изтекло

---

## Тестване
Функционалността е тествана чрез REST заявки, които покриват:
- конкурентни опити за задържане на едно място
- опит за покупка от различен потребител
- успешна покупка
- поведение при вече продадено място

**POST /seats/{id}/hold?userId={userId}** - Hold-ва дадено място
**POST /seats/{id}/confirm?userId={userId}** - Confirm-ва дадено място
---

## Използвани технологии
- Java
- Spring Boot
- Maven
- REST API
- Embedded Tomcat

---

## Заключение
Проектът демонстрира реална бизнес логика с конкурентен достъп,
временно задържане на ресурси и автоматично управление на състоянията.
Това покрива изискванията за повишена сложност и синхронизация в backend приложение.
